*xtabline.txt*    Version 0.4.0    Last change: August 14 2019

XTABLINE - TABLE OF CONTENTS                                        *xtabline*
==============================================================================

  Introduction                                   |xtabline-introduction|
  Features                                       |xtabline-features|
  Tabline rendering                              |xtabline-rendering|
  Main mappings                                  |xtabline-basic|
  Initialization                                 |xtabline-init|
  Tabline modes                                  |xtabline-modes|
  Tabline paths                                  |xtabline-paths|
  Tab working directories                        |xtabline-directories|
  Tab buffers                                    |xtabline-buffers|
  Managing tabs and buffers                      |xtabline-manage|
  Session management                             |xtabline-sessions|
  Other commands                                 |xtabline-other|
  Settings                                       |xtabline-settings|
  Other options                                  |xtabline-options|
  Additional notes                               |xtabline-notes|
  Credits                                        |xtabline-credits|
  License                                        |xtabline-license|



INTRODUCTION                                           *xtabline-introduction*
==============================================================================

This plugin tries to give you full control on the tabline:

* buffer filtering on the base of the current CWD, or other directories
* three tabline modes: tabs, (filtered) buffers, |arglist|
* limit rendered buffers to the N most recently accessed (default 10)
* optional persistance in sessions

More features:

* tab CWD/name is shown in the right corner of the tabline
* commands to quickly set/change (tab/window) working directory
* buffers quick navigation (next, previous, with [count])
* reopen closed tabs
* clean up buffers across all tabs
* session management: load/save/delete sessions, with dates/descriptions
* tabs bookmarks: load/save customized tabs from/to disk
* tab-todo: customizable command to open a todo file for that tab

With the help of:

* |vim-obsession| for persistance of customizations across sessions





FEATURES LIST                                             *xtabline-features*
==============================================================================

The main features of the plugin are:

- custom tabline rendering    |xtabline-rendering|
- buffer filtering            |xtabline-buffer_filtering|
- tabs management             |xtabline-manage|
- sessions management         |xtabline-sessions|

By default, only tabline rendering is enabled: more specific options must be
enabled manually. Without any option set, you will see a different tabline,
but the rest works normally.

Buffer filtering makes sense if per-tab CWD is being used, either via |:tcd|
or |:lcd|. It means that in the tabline, only buffers that are valid for the
tab's CWD will be listed.

The last two are a series of commands that allow you to save/restore tabs and
sessions.

|vim-obsession| {1} is recommended for persistance.




TABLINE RENDERING                                         *xtabline-rendering*
==============================================================================

The tabline can be rendered in three different modes:

- 'tabs':     tab name, CWD, or buffer name
- 'arglist':  buffers contained in the arglist
- 'buffers':  up to a max of N (default 10) recent buffers

Default order is ['tabs', 'buffers', 'arglist'].

In |tabs-mode|, the tabline will show the numbered tabs. The label can be
customized as well (to show buffer name, tab cwd, etc). This is the closest to
vim default tabline, and it's the default mode.

In |arglist-mode|, the tabline will show the files included in the arglist.
You can switch file with the usual commands (|:next|, etc). Note that if the
arglist is empty, this mode won't be available.

In |buffer-mode|, the tabline will show a list of the most recently accessed
buffers (10 by default). This list will be filtered on the base of the current
tab's CWD, if |buffer_filtering| is active.





MAIN MAPPINGS                                                 *xtabline-basic*
==============================================================================

These are the default mappings for the most common functionalities. Mappings
can be disabled (|xtabline-enable_mappings|) or redefined (by directly mapping
ex commands).

<F5>        cycle among the modes described above. You can also define which
            modes to cycle with a setting. See |xtabline-tabline_modes|.

[count]<BS> used to select tabs or buffers. See |xtabline-select-buffer|.

cd...       a series of mappings used to change/display working directories
            and related stuff. See |xtabline-directories|.

<leader>x?  show all default mappings




INITIALIZATION                                                 *xtabline-init*
==============================================================================

Here are described the most important settings, for the full list read
|xtabline-settings|.

First you have to initialize the settings dictionary:
>
    let g:xtabline_settings = {}


-------------------------------------------------------- *xtabline-map_prefix*
>
    let g:xtabline_settings.map_prefix = '<leader>x'

Most of xtabline mappings can be associated to a prefix.
This means that most commands will be mapped to `<leader>x` + a modifier.
You can change the prefix and all mappings will be changed accordingly.
Most mappings presented are meant prefixed by <prefix>, when preceded by *.


----------------------------------------------------- *xtabline-tabline_modes*
>
    let g:xtabline_settings.tabline_modes = ['tabs', 'buffers', 'arglist']

The modes that can be put in this list are:

- |tabs|:       similar to the default vim tabline, with CWD in the corner
- |buffers|:    buffer names, formatted with |xtabline-buffer_format|.
- |arglist|:    the files contained in the arglist, as shown by |:args|

The modes can be cycled with <F5> (default).


-------------------------------------------------- *xtabline-buffer_filtering*
>
    let g:xtabline_settings.buffer_filtering = 1
<
Set this value to 0 to disable directory-based buffer filtering.


---------------------------------------------------- *xtabline-relative_paths*
>
    let g:xtabline_settings.relative_paths = 1

Note that this setting is both global and specific to tabs. This means that
when a tab is created, it inherits the global setting, but if you want to
change it with the |XTabRelativePaths| command, the other tabs won't be
affected.






TABLINE MODES                                                 *xtabline-modes*
==============================================================================

Command                Mapping~
XTabCycleMode           <F5>
XTabFiltering           *f

*XTabCycleMode*     will cycle the tabline among the modes defined by the
                  |xtabline-tabline_modes| setting.

*XTabFiltering*     will toggle buffer filtering, based on either the tab's
                  CWD or base directory.







TABLINE PATHS                                                 *xtabline-paths*
==============================================================================

Both in 'tabs' and 'buffers' mode, the path can be displayed in several ways.
Vim's default is to show a shortened version of the file's path, with
directory names reduced to a single letter. I don't find this format to be
very readable, but it generally gives you an idea of the file position. This
is still the default in xtabline.

There are alternatives, though, controlled by a command (|XTabRelativePaths|),
and by a setting (|xtabline-relative_paths|). The setting defines the default
for new tabs, while the command defines a tab-specific value for this setting.

---------------------------------------------------------- *XTabRelativePaths*
Command                           Mapping~
XTabRelativePaths                 *+
XTabRelativePaths!                *-

Without a [count], the command toggles between basename and relative path in
the tabline. With a count, the text displayed will vary for positive or
negative values. For example, with a path: >

  long/path/to/file.ext

different values will display the path in the following ways:
>
     -2  ->   path/to/file.ext
     -1  ->   to/file.ext
      0  ->   file.ext
      1  ->   l/p/t/file.ext      (default)
      2  ->   l/p/to/file.ext

Notice that there are two mappings, *+ and *-, with the second one that sets
a negative value.






TAB WORKING DIRECTORIES                                 *xtabline-directories*
==============================================================================

Mappings and commands are provided to set a tab's working directory.
If the command is used with <bang>, directory prompt is skipped.

Command          Mapping~
*XTabWD* [!] <dir>  cdw     Set the tab CWD
*XTabLD* [!] <dir>  cdl     Set a window-local WD
*XTabTD* [!] <dir>  cdt     Set a tab-local WD
*XTabCD* [!] <dir>  cdc     |:cd| to dir of open buffer, or <count> down
*XTabInfo*          cd?     show current cwd (global/local/tab), git dir, tags

Note that |:tcd| is only available in neovim and the most recent vim versions
(>= 8.1).





TAB BUFFERS                                                 *xtabline-buffers*
==============================================================================
                                                      *xtabline-select-buffer*
Plug                              Mapping~
<Plug>(XT-Select-Buffer)          [count] <BS>

Command                           Mapping~
XTabNextBuffer                    [count] ]b
XTabPrevBuffer                    [count] [b
XTabCloseBuffer                   *q
XTabHideBuffer                    *h
XTabMoveBuffer                    *m
XTabMoveBufferNext                *]
XTabMoveBufferPrev                *[
XTabPinBuffer                     *p

------------------------------------------------------------------------------

`Select-Buffer` works this way:

* it needs a [count] to work, eg. 2<BS> would bring you to buffer #2
* when not using a [count], it will execute a command of your choice

Define this command by setting the |select_buffer_alt_action| variable.
Default is `:buffer #` (go to alternate buffer).

When in |tabs-mode|, [count]<BS> can still be used, and will bring you to the
N tab (<BS> is an alias for |gt| in this case).

------------------------------------------------------------------------------

*XTabNextBuffer* and *XTabPrevBuffer* accept a [count], to move to ±N buffer,
as they are shown in the tabline.  If moving beyond the limit, it will start
from the start (or the end).

------------------------------------------------------------------------------

*XTabCloseBuffer* will close and delete the current buffer, while keeping the
window open, and loading either:

* the alternate buffer
* a valid buffer for the tab

------------------------------------------------------------------------------

*XTabHideBuffer* removes the buffer from the list of recent buffers for the
tab, effectively hiding it from the tabline if there are enough tab buffers,
so that the next most recent one will take its place. Then [count] buffer will
be selected, as by |Select-Buffer|. Selects first if no count is given.
Differently from |XTabCloseBuffer|, the buffer is not deleted.

------------------------------------------------------------------------------

*XTabMoveBuffer* will move the current buffer at [count] position, or first if
no count is given.

------------------------------------------------------------------------------

*XTabMoveBufferNext* and *XTabMoveBufferPrev* move the current buffer to the
next/previous position in the tabline, but they only work for buffers that are
considered valid for the current tab.

------------------------------------------------------------------------------

*XTabPinBuffer* pins a buffer, so that it will be visible in all tabs.






MANAGING TABS AND BUFFERS                                    *xtabline-manage*
==============================================================================


Command                Mapping~
XTabLast               *\
XTabReopen             *u

*XTabLast*    brings you back to the last visited tab
*XTabReopen*  reopen a previosly closed tab


Command                Mapping~
XTabListTabs           *a           (mnemonic: 'all tabs')
XTabListBuffers        *z           (mnemonic: just below previous)
XTabLoadTab            *tl
XTabSaveTab            *ts
XTabDeleteTab          *td
XTabDeleteBuffers      *bd

Saved tabs are stored in `$HOME/.vim/.XTablineTabs`.





SESSION MANAGEMENT                                         *xtabline-sessions*
==============================================================================

Command                Mapping ~
XTabLoadSession        *sl
XTabSaveSession        *ss
XTabDeleteSession      *sd
XTabNewSession         *sn

Descriptions are saved in `$HOME/.vim/.XTablineSessions`.

Session commands operate on sessions found in the specified directory.
Default:
>
  let g:xtabline_settings.sessions_path = '$HOME/.vim/session'

When loading sessions, the last modification date will be shown, along with
the description and the symbol `[%]` that marks the active session (if any).






OTHER COMMANDS                                                *xtabline-other*
==============================================================================

Command                Mapping~
XTabCustomLabels       *.
XTabPurge              *x
XTabCleanUp            *k
XTabCleanUp!           *K
XTabTodo               *d
XTabTheme              *T

*XTabNERDBookmarks*   opens the list of |NERDTreeBookmarks|
*XTabCustomLabels*    toggles visibility of tab customizations (name, icon)


BUFFERS CLEAN-UP                                           *xtabline-clean-up*

*XTabPurge*

This command is handy to close all buffers that aren't bound to a physical
file (eg. git logs, previews, quickfix windows etc). The tab won't be closed.

*XTabCleanUp* [!]

This command deletes all buffers from the global buffers list, that are not
valid for any of the current tabs. Useful to get rid of terminal buffers in
neovim, for example, or to keep slim your buffer list.

With a bang, it also deletes tab buffers, leaving only the currently open
windows/buffers for each tab.


TAB-TODO                                                   *xtabline-tab-todo*

This command opens a todo file at the tab's CWD.

Inside the todo buffer, `\q` does |:update| and closes the buffer.

You can define the filename and other options:
>
  let g:xtabline_settings.todo = { 'file': '.TODO', 'prefix': 'below',
    \'command': 'sp', 'size': 20, 'syntax': 'markdown'}

`file`    : the filename that will be used
`command` : eg. `below 20sp`, `vs`, `edit`, etc, check |opening-window|
`syntax`  : the filetype that will be assigned


CUSTOMIZING TABS AND BUFFERS           *xtabline-customizing-tabs-and-buffers*

Command                Mapping~
XTabRenameTab          *tn
XTabRenameBuffer       *bn
XTabIcon               *ti
XTabBufferIcon         *bi
XTabResetTab           *tr
XTabResetBuffer        *br

*XTabResetTab*        reset tab customizations
*XTabRenameBuffer*    it doesn't rename the REAL buffer!
*XTabResetBuffer*     reset buffer customization

When assigning an icon, you can autocomplete the icon name, or insert a single
character. To expand the list of available icons for autocompletion, see
|xtabline-customization|






SETTINGS                                                   *xtabline-settings*
==============================================================================
                                                         *xtabline-enabled*  >
    let g:xtabline_settings.enabled = 1

If set to 0, xtabline is disabled. You can also disable it per-buffer, if you
set a buffer variable:
>
  let b:no_xtabline = 1
<

--------------------------------------------------- *xtabline-enable_mappings*
>
    let g:xtabline_settings.enable_mappings = 1

Mappings are enabled by default.


------------------------------------------------ *xtabline-enable_persistance*
>
    let g:xtabline_settings.enable_persistance = 0

Persistance is disabled by default. It is used to save in current session file
informations such as custom tabs labels or pinned buffers.


------------------------------------------------- *xtabline-show_right_corner*
>
    let g:xtabline_settings.show_right_corner = 1
<
Set this value to 0 to remove the label on the right corner of the tabline.


------------------------------------------------- *xtabline-wd_type_indicator*
>
    let g:xtabline_settings.wd_type_indicator = 0
<
Disabled by default, if enabled it adds an indicator in the right corner:

- `W`: there is a window-local directory set for the current buffer
- `T`: there is a tab-local directory set for the current tab

Only one letter will be shown, and window-local directories override tab-local
ones.

---------------------------------------------------- *xtabline-recent_buffers*
>
    let g:xtabline_settings.recent_buffers = 10

The number of buffers that can be shown in the tabline is limited (by default)
to the 10 most recently accessed buffers.


--------------------------------------------------- *xtabline-last_open_first*
>
    let g:xtabline_settings.last_open_first = 0

Valid buffers will be ordered by time of access. Note that special or extra
buffers can still be listed before them, but they are also highlighted
differently.


----------------------------------------------------- *xtabline-buffer_format*
>
    let g:xtabline_settings.buffer_format = 2

This setting controls how the buffers are formatted in the tabline. Valid
values are:

  `1`       the buffer number (as by bufnr('%')), and the buffer base name
  `2`       the buffer position in the tabline, and the buffer base name
  `func`    a funcref (the buffer number is passed as parameter)

Function example:
>
    fun! MyBuflineFormat(bufnr)
      let A = '%#TabLineSel#'
      let B = bufnr('%') == a:bufnr ? '%#PmenuSel#' : '%#TabLine#'
      let name = bufname(a:bufnr) != '' ? bufname(a:bufnr) : '...'
      return printf('%s %s %s %s ', A, a:bufnr, B, name)
    endfun

    let g:xtabline_settings.buffer_format = function('MyBuflineFormat')


-------------------------------------------------------- *xtabline-tab_format*
>
    let g:xtabline_settings.tab_format = 1

    = 0  ->  long/path/to/file.ext  ->   file.ext
    = 1  ->  long/path/to/file.ext  ->   l/p/t/file.ext
    = 2  ->  long/path/to/file.ext  ->   l/p/to/file.ext

As above, but for tabs mode. The value must be an integer.
If a tab has a custom name, this will have higher priority.


------------------------------------------------- *xtabline-tabs_show_bufname*
>
    let g:xtabline_settings.tabs_show_bufname = 0

If enabled, tabs will always show the buffer name, not the directory name.


---------------------------------------- *xtabline-close_buffer_can_close_tab*
                                          *xtabline-close_buffer_can_quit_vim*
Default: 0

They affect whether the |XTabCloseBuffer| command can close a tab or even quit
vim, respectively.






OTHER OPTIONS                                               *xtabline-options*
==============================================================================

You can add any of these to your *.vimrc*, after having initialized the
`g:xtabline_settings` dictionary.

    let g:xtabline_settings = {}
    let g:xtabline_settings.option_name = option_value

---------------------------+--------------------------------------------------
Option                     | Default ~
---------------------------+--------------------------------------------------
select_buffer_alt_action   | `buffer #`
sessions_path              | `~/.vim/session`
close_buffer_can_close_tab | 0
close_buffer_can_quit_vim  | 0
bookmarks_file             | `~/.vim/.XTablineBookmarks`
sessions_data              | `~/.vim/.XTablineSessions`


FORMATTING                                             *xtabline-formatting*

---------------------------+--------------------------------------------------
Option                     | Default ~
---------------------------+--------------------------------------------------
relative_paths             | 0
buffer_format              | 2
tab_format                 | 1
modified_flag              | '* '
tab_icon                   | ["📂", "📁"]

`icons` are the ones that can be used when assigning an icon to a tab/buffer,
and can be used in other contexts (special buffers icon).
>
  let g:xtabline_settings.bufline_indicators = {
      \ 'modified': '[+]',
      \ 'readonly': '[🔒]',
      \ 'scratch': '[!]',
      \ 'pinned': '[📌]',
      \}

  let g:xtabline_settings.icons = {
      \'pin': '📌',
      \'star': '★',
      \'book': '📖',
      \'lock': '🔒',
      \'hammer': '🔨',
      \'tick': '✔',
      \'cross': '✖',
      \'warning': '⚠',
      \'menu': '☰',
      \'apple': '🍎',
      \'linux': '🐧',
      \'windows': '⌘',
      \'git': '',
      \'palette': '🎨',
      \'lens': '🔍',
      \'flag': '🏁',
      \}




ADDITIONAL NOTES                                              *xtabline-notes*
==============================================================================

Note that |vim-obsession| isn't mandatory: the only caveat is that, if you
have it installed, xtabline will not touch session files by itself, and
persistance will not be enabled on sessions that aren't handled by
|vim-obsession|.

You may need some patched font for icons. In a Debian-based distribution you
can install the following packages:

- ttf-ancient-fonts-symbola
- fonts-powerline

In Windows, one of the pre-patched `nerd-fonts` is recommended. For gVim
I recommend the 1.2.0 release.

     https://github.com/ryanoasis/nerd-fonts/releases





CREDITS                                                     *xtabline-credits*
==============================================================================

Bram Moolenaar for Vim
Buftabline for the bufferline rendering  https://github.com/ap/vim-buftabline
Taboo for the tabline rendering          https://github.com/gcmt/taboo.vim
Tim Pope for [vim-obsession]             https://github.com/tpope/vim-obsession
Kana Natsuno for [tabpagecd]             https://github.com/kana/vim-tabpagecd



LICENSE                                                     *xtabline-license*
==============================================================================

MIT


vim:tw=78:et:sw=2:ts=2:ft=help:nowrap:
